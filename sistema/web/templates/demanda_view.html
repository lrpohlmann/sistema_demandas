{% extends "base.html" %}
{% from 'macros/demanda/lista_dados_demanda.html' import lista_dados_demanda %}
{% from 'macros/tarefa/tarefa_card.html' import tarefa_card %}
{% from 'macros/tarefa/criar_tarefa.html' import criar_tarefa %}
{% from 'macros/demanda/linha_do_tempo_offcanvas.html' import linha_do_tempo %}

{% block main %}
<div>
    <h1>{{demanda.titulo}}</h1>
</div>
<div class="row">
    <div class="col-6">
        {{lista_dados_demanda(demanda, demanda.id_demanda)}}
    </div>
    <div class="col-6">
        <button type="button" class="btn btn-primary" data-bs-toggle="offcanvas"
            data-bs-target="#linha-do-tempo-offcanvas">Linha do Tempo</button>
    </div>
    <div class="col-6">
        {% if demanda.documentos %}
        <div>
            <ul>
                {% for doc in demanda.documentos %}
                <li>
                    <div><a href="{{url_for('download_arquivo_view', nome_arquivo=doc.arquivo)}}"
                            download="">{{doc.nome}}</a></div>
                </li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        <div hx-get="{{url_for('inserir_documento_view', demanda_id=demanda.id_demanda)}}" hx-swap="outerHTML"
            hx-trigger="load">
        </div>
    </div>
</div>
<div>
    <div class="col">
        <div class="row">
            <div class="col-12">
                <h2>Tarefas</h2>
            </div>
            <div class="col-6">
                <div class="row">
                    <div class="col-12" hx-get="{{url_for('tarefa_card_view', demanda_id=demanda.id_demanda)}}"
                        hx-swap="innerHTML" hx-trigger="load, tarefaCriada from:body" hx-params="none">
                    </div>
                </div>
            </div>
            <div class="col-6">
                {{criar_tarefa(criar_tarefa_form, demanda.id_demanda)}}
            </div>
        </div>
    </div>
    {{linha_do_tempo(demanda.id_demanda, form_criar_fato)}}
</div>
{% endblock %}